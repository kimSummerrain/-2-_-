<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Split Layout with Scrollable Checklist</title>
    <!-- Bootstrap CSS -->
    <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      .back-button {
        position: absolute;
        top: 20px;
        left: 20px;
        width: calc(12.5%);
        max-width: 60px;
        border: 4px solid #dee2e6;
        border-radius: 8px;
        padding: 4px;
        background-color: #f8f9fa;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        cursor: pointer;
        transition: transform 0.2s ease-in-out;
      }
      body {
        font-family: 'Jua', sans-serif;
      }
      .back-button:hover {
        transform: scale(1.1);
      }
      .back-button img {
        width: 100%;
        height: auto;
        display: block;
        border-radius: 4px;
      }
      .split-container {
        height: 100vh;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        gap: 20px;
        padding: 20px;
      }
      .content {
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-grow: 1;
        gap: 20px;
      }
      .image-container {
        flex: 4;
        display: flex;
        justify-content: center;
        align-items: center;
        position: relative;
      }
      .image-container img {
        max-width: 80%;
        height: auto;
        border-radius: 8px;
        object-fit: contain;
        position: relative;
        z-index: 1;
      }
      .carrier-fill {
        position: absolute;
        bottom: 12%;
        left: 25%;
        width: 50%;
        height: 0%;
        background-color: rgba(0, 123, 255, 0.5);
        z-index: 0;
        border-radius: 0 0 8px 8px;
      }
      .checklist-container {
        flex: 6;
        background-color: #f8f9fa;
        border: 1px solid #dee2e6;
        border-radius: 8px;
        padding: 20px;
        overflow-y: scroll;
        max-height: 80%;
      }
      .checklist-item {
        margin-bottom: 15px;
      }
      .travel-button {
        width: 100%;
        max-width: 300px;
        background-color: #dee2e6;
        color: black;
        border: none;
        border-radius: 8px;
        padding: 10px 20px;
        font-size: 16px;
        font-weight: bold;
        cursor: not-allowed;
        transition: background-color 0.3s ease, color 0.3s ease;
        align-self: center;
        margin-top: -20px;
      }
      .travel-button.enabled {
        background-color: #007bff;
        color: white;
        cursor: pointer;
      }
      .hidden-checklist {
        visibility: hidden; /* 체크리스트 내용을 숨김 */
      }
      
    </style>
  </head>
  <body>
    <div class="split-container">
      <a href="#" class="back-button">
        <img src="./static/images/back.png" alt="Back" />
      </a>
      <div class="content">
        <div class="image-container">
          <div class="carrier-fill" id="carrier-fill"></div>
          <img id="carrier-image" src="./static/images/carrier2.png" alt="Suitcase Icon" />
        </div>
        <div id="checklist-container" class="checklist-container">
          <h3 class="text-center">Checklist</h3>
          <div id="checklist"></div>
        </div>
      </div>
      <button id="travel-button" class="travel-button" disabled>
        여행 가기
      </button>
    </div>
    <script>
const checklistData = [
        { id: 1, text: "상비약", completed: false },
        { id: 2, text: "여분의 옷", completed: false },
        { id: 3, text: "여권", completed: false },
        { id: 4, text: "속옷", completed: false },
        { id: 5, text: "세면도구", completed: false },
        { id: 6, text: "현금", completed: false },
        { id: 7, text: "비자카드", completed: false },
        { id: 8, text: "여행자보험", completed: false }
      ];
      const checklistContainer = document.getElementById("checklist");
      const travelButton = document.getElementById("travel-button");
      const carrierFill = document.getElementById("carrier-fill");

      function updateCarrierCapacity() {
        const carrierContainer = document.querySelector(".image-container");
        const containerHeight = carrierContainer.clientHeight * 0.565;
        const totalItems = checklistData.length;
        const checkedItems = Array.from(
          document.querySelectorAll(".form-check-input:checked")
        ).length;
        const heightPerItem = containerHeight / totalItems;
        carrierFill.style.height = `${heightPerItem * checkedItems}px`;
      }

      function updateButtonState() {
        const allChecked = Array.from(
          document.querySelectorAll(".form-check-input")
        ).every((checkbox) => checkbox.checked);
        if (allChecked) {
          travelButton.classList.add("enabled");
          travelButton.removeAttribute("disabled");
        } else {
          travelButton.classList.remove("enabled");
          travelButton.setAttribute("disabled", "true");
        }
      }

      checklistData.forEach((item) => {
        const checklistItem = document.createElement("div");
        checklistItem.className = "form-check checklist-item";
        const checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.className = "form-check-input";
        checkbox.id = `checklist-${item.id}`;
        checkbox.checked = item.completed;
        const label = document.createElement("label");
        label.className = "form-check-label";
        label.htmlFor = `checklist-${item.id}`;
        label.innerText = item.text;
        checklistItem.appendChild(checkbox);
        checklistItem.appendChild(label);
        checklistContainer.appendChild(checklistItem);
        checkbox.addEventListener("change", () => {
          updateCarrierCapacity();
          updateButtonState();
        });
      });

      updateCarrierCapacity();
      updateButtonState();

      window.addEventListener("resize", () => {
        updateCarrierCapacity();
      });

      travelButton.addEventListener("click", () => {
        if (travelButton.classList.contains("enabled")) {
          travelButton.style.backgroundColor = "green";
          travelButton.innerText = "출발 준비 완료!";

          // 1. 체크리스트 숨기기
          const checklistContainer = document.getElementById("checklist-container");
          checklistContainer.classList.add("hidden-checklist");

          // 2. carrierFill 숨기기
          const carrierFill = document.getElementById("carrier-fill");
          carrierFill.style.display = "none";

          // 3. carrier2.png를 carrier3.png로 변경
          const carrierImage = document.getElementById("carrier-image");
          carrierImage.src = "./static/images/carrier3.png";

                // 4. carrier3.png를 오른쪽으로 X축 이동
          let position = 0; // 초기 위치
          const maxPosition = 500; // 최대 이동 거리 (픽셀)
          const step = 10; // 한 번에 이동할 거리
          const intervalTime = 50; // 이동 간격 (밀리초)

          const moveRightInterval = setInterval(() => {
            if (position < maxPosition) {
              position += step;
              carrierImage.style.transform = `translateX(${position}px)`;
              carrierImage.style.transition = "transform 0.05s ease"; // 부드러운 애니메이션
            } else {
              clearInterval(moveRightInterval); // 최대 위치에 도달하면 이동 멈춤
              showWalkingAnimation(); // 걷는 애니메이션 표시
            }
          }, intervalTime);

          // 4. carrier3.png를 오른쪽으로 5도씩 3번 회전
          let rotation = 0;
          let count = 0;

          const rotateInterval = setInterval(() => {
            if (count < 6) { // 5도씩 3번 회전 = 총 15도
              rotation += 5; 
              carrierImage.style.transform = `rotate(${rotation}deg)`;
              carrierImage.style.transition = "transform 1s ease"; // 부드러운 애니메이션
              count++;
            } else {
              clearInterval(rotateInterval); // 회전 끝
              // 모든 이벤트 완료 후 걷는 애니메이션 표시
              showWalkingAnimation();
            }
          }, 300); // 0.3초 간격
        }
      });

      

    </script>
  </body>
</html>